{% extends '_base.html' %}

{% block page_title %}Consultation d'une recette{% endblock %}

{% load static %}
{% load ratings %}

{% block body_content %}
<div class="body">
				<div id="content">
					<div>
						<div>
							<h3>{{ recipe.name }} - {% if request.user.is_authenticated and recipe.user.id == request.user.id %}
                                <a href="{% url 'recipesWebsite:editRecipe' recipe.id %}">Modifier</a> -
                                <a href="{% url 'recipesWebsite:deleteRecipe' recipe.id %}">Supprimer</a>
                                {% endif %}</h3>
							<p>
								This website template has been designed by <a href="http://www.freewebsitetemplates.com/">Free Website Templates</a> for you, for free. You can replace all this text with your own text. You can remove any link to our website from this website template, you&#39;re free to use this website template without linking back to us. If you&#39;re having problems editing this website template, then don&#39;t hesitate to ask for help on the <a href="http://www.freewebsitetemplates.com/forums/">Forums</a>.
							</p>
							<a href="index.html"><img src="/images/pork-barbeque.jpg" alt="Image"></a>

                            <p>Type : {{ recipe.get_type_display }}</p>

                            <p>Niveau de difficulté : {{ recipe.get_difficultyLevel_display }}</p>

                            <p>Coût : {{ recipe.cost|default:"0" }} €</p>

                            <p>Temps de préparation : {{ recipe.prepareTime|default:"0" }} min.</p>

                            <p>Temps de cuisson : {{ recipe.cookTime|default:"0" }} min.</p>

                            <p>Temps de repos : {{ recipe.restTime|default:"0" }} min.</p>
                            <br />

							<h5>INGRÉDIENTS</h5>
							<ol class="ingredients">
								<li>
									{{ recipe.ingredientList }}
								</li>
							</ol>
							<h5>ÉTAPES</h5>
                            {{ recipe.steps }}


                          <h5>PHOTOS</h5>
							<ol class="pictures">
                              {% for image in images %}
                                  <img src="/media/{{ image.file }}" width="100" height="100"/>
                              {% endfor %}
                            </ol>

                          <h5>NOTER LA RECETTE</h5>
                            {% ratings recipe %}

                          <h5>COMMENTAIRES ({{ totalComments }})</h5>
                          {% if totalComments > 0 %}
                          <table border="1">
                            <tbody>
                              {% for comment in comments %}
                                <tr>
                                  <td>{{ comment.user.username }}</td>
                                  <td>{{ comment.content }}</td>
                                  <td>{{ comment.createdAt }}</td>
                                </tr>
                              {% endfor %}
                            </tbody>
                          </table>
                          {% endif %}

                        <br/>

                          {% if comments.has_other_pages %}
                            <ul class="pagination">
                              {% if comments.has_previous %}
                                <li><a href="?page={{ comments.previous_page_number }}">&laquo;</a></li>
                              {% else %}
                                <li class="disabled"><span>&laquo;</span></li>
                              {% endif %}
                              {% for i in comments.paginator.page_range %}
                                {% if comments.number == i %}
                                  <li class="active"><span>{{ i }} <span class="sr-only">(current)</span></span></li>
                                {% else %}
                                  <li><a href="?page={{ i }}">{{ i }}</a></li>
                                {% endif %}
                              {% endfor %}
                              {% if comments.has_next %}
                                <li><a href="?page={{ comments.next_page_number }}">&raquo;</a></li>
                              {% else %}
                                <li class="disabled"><span>&raquo;</span></li>
                              {% endif %}
                            </ul>
                          {% endif %}

                          {% if request.user.is_authenticated %}
                            <form class="comment_form" action="{% url 'recipesWebsite:addComment' recipe.id %}" method="post">
                                {% csrf_token %}
                                {{ form.as_p }}
                                <input type="submit" value="Comment" />
                            </form>
                          {% endif %}
						</div>
					</div>
				</div>
			</div>
{% endblock %}
